name: Try_win
# this workflow is triggered from UI
on:
  workflow_dispatch:

jobs:
  build:
    # maybe https://github.com/actions/runner-images/blob/main/images/windows/Windows2022-Readme.md
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: check applications installed
        run: |
         echo "npm --version"
         npm --version
         echo "jq --version"
         jq --version

      - name: 0) Read package.json version
        id: package_version
        run: |
          # Extract the version from package.json and store it as an environment variable
          @echo off
          for /f "delims=" %%i in ('jq -r ".version" package.json') do set VERSION=%%i
          echo Package version is  %VERSION%
          if not "%GITHUB_REF_NAME%"=="v%VERSION%" (
            echo ðŸ”´ Error: Tag %GITHUB_REF_NAME% does not match version v%VERSION%
            exit /b 1
          )
          echo "VERSION=%VERSION%" >> $GITHUB_ENV